<!--   DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS HEADER.

Copyright 2005, 2011 Oracle and/or its affiliates. All rights reserved.
 
Use is subject to License Terms  -->


<a name="task-jdbcconnectionpooladvance"></a><h3>JDBC 接続プールの詳細属性を編集する</h3><a name="indexterm-11"></a><ol>
<li><b>ナビゲーションツリーで、「リソース」ノードを展開します。</b></li>
<li><b>「リソース」ノードで、「JDBC」ノードを選択します。</b></li>
<li><b>「JDBC」ノードで、「接続プール」ノードを選択します。</b><p>「接続プール」ページが開きます。</p></li>
<li><b>「接続プール」ページで、編集するプールの名前をクリックします。</b><p>「接続プールを編集」ページが開きます。</p></li>
<li><b>「接続プールを編集」ページで、「詳細」タブをクリックします。</b><p>「接続プールの詳細属性を編集」ページが開きます。</p></li>
<li><b>「文のタイムアウト」フィールドに、実行時間が異常に長いクエリーを停止するまでの時間を秒単位で入力します。</b><p>GlassFish Server は、作成される文に <tt>QueryTimeout</tt> を設定します。値を -1 に設定すると、このオプションが無効になります。デフォルト値は -1 です。</p></li>
<li><b>「文のキャッシュサイズ」フィールドに、LRU (Least Recently Used) キャッシュメカニズムを使用してキャッシュされる文の数を入力します。</b><p>文のキャッシュを無効にするには、0 を指定します。デフォルト値は 0 です。</p></li>
<li><b>「SQL の初期化」フィールドに、接続がプールに作成される (再使用でない) ときに実行される SQL 文字列を入力します。</b><p>この文字列の実行で、接続の状態が初期化されます。</p></li>
<li><b>「SQL トレースリスナー」フィールドに、リスナー実装クラス名のコンマ区切りのリストを入力して、アプリケーションによって実行される SQL 文を監視することを指定します。</b><p>リスナークラスは  <tt>org.glassfish.api.jdbc.SQLTraceListener</tt>  インタフェースを実装する必要があります。リスナーを使用すると、SQL 文のログメッセージに簡単にフィルタを適用することができ、管理者が文を解析する際に役立ちます。</p></li>
<li><b>アプリケーションの「JDBC オブジェクトをラップ」の「有効」チェックボックスを選択して、<tt>Statement</tt>、<tt>PreparedStatement</tt>、<tt>CallableStatement</tt>、<tt>ResultSet</tt>、<tt>DatabaseMetaData</tt> に対してラップされた JDBC オブジェクトを取得します。 </b><p>このオプションはデフォルトで有効になっています。</p></li>
<li><b>「プール」チェックボックスを選択して、プールの接続プールを有効にします。</b><p>このオプションはデフォルトで有効になっています。</p></li>
<li><b>「最大で 1 回検証」フィールドに、接続を最大で 1 回だけ検証するまでの時間を秒単位で入力します。</b><p>この属性を適切な値に設定すると、接続ごとの確認要求回数を最小にすることができます。デフォルト値は 0 です。この属性が無効であることを意味します。</p></li>
<li><b>「リークタイムアウト」フィールドに、接続プールの接続リークを監視する時間を秒単位で入力します。</b><p>このフィールドを使用して、アプリケーションによる接続リークの可能性を検出します。アプリケーションが指定された期間内に接続をプールに戻さなかった場合、この接続はリークしている可能性があると見なされ、呼び出し側のスタックトレースがログに記録されます。接続リークのトレースを無効にするには、値を 0 に設定します。デフォルト値は 0 です。</p><p>このフィールドを「リーク再要求」とともに使用すると、アプリケーションによる潜在的な接続リークを避けることができます。</p></li>
<li><b>リーク接続のトレースの完了後に、リークした接続をプールに戻すには、「リーク再要求」チェックボックスを選択します。</b><p>このオプションは、デフォルトでは無効になっています。</p></li>
<li><b>「作成再試行回数」フィールドに、新しい接続の作成時に障害が発生した場合の試行回数を入力します。</b><p>値を 0 に設定すると、接続の再作成は試行されません。デフォルト値は 0 です。</p></li>
<li><b>「再試行間隔」フィールドに、接続作成の試行間隔を秒単位で入力します。</b><p>デフォルト値は 10 です。この属性は、「作成再試行回数」が 1 以上の場合にのみ使用されます。</p></li>
<li><b>「使用時にのみ関連付け」の「有効」チェックボックスを選択して、物理的な接続を、接続が使用されているときにのみ論理的な接続に関連付けます。</b><p>トランザクションが完了してコンポーネントメソッドが終了したときに関連付けが解除されるため、物理的な接続を再利用しやすくなります。このオプションが無効な場合、物理的な接続は使用される前でも論理的な接続に関連付けられます。このオプションは、デフォルトでは無効になっています。</p></li>
<li><b>「使用時にのみ接続を登録」の「有効」チェックボックスを選択して、リソースが実際にメソッドで使用されるときのみ、トランザクションにリソースを登録します。</b><p>このオプションは、デフォルトでは無効になっています。</p></li>
<li><b>「スレッドとの関連付け」の「有効」チェックボックスを選択して、接続とスレッドの間の関連付けを作成します。</b><p>同じスレッドが別の接続で必要なときには、そのスレッドにすでに関連付けられている接続を再使用できるため、プールから別の接続を取得するオーバーヘッドが発生しません。このオプションは、デフォルトでは無効になっています。</p></li>
<li><b>「接続のマッチング」の「有効」チェックボックスを選択して、プールに対する接続の照合を有効にします。</b><p>このオプションが有効な場合、プールから選択された接続は、特定の証明書を持つ接続にマッチングされます。複数のユーザー証明書を持つアプリケーションによって接続プールが使用されている場合は、このオプションを有効にする必要があります。プール内の接続が常に同じ種類であり、プールから選択した接続とリソースアダプタを照合する必要がないことを管理者が理解している場合は、このオプションを無効に設定できます。このオプションは、デフォルトでは無効になっています。</p></li>
<li><b>「最大接続使用数」フィールドに、接続をプールで再利用する回数を入力します。</b><p>指定された回数だけ再利用されると、その接続は閉じられます。接続を再利用できる回数を制限することにより、アプリケーションが文を閉じていない場合に、文のリークを避けることができます。この属性を無効にするには、値を 0 に設定します。デフォルト値は 0 です。</p></li>
<li><b>「接続検証」の「必要」チェックボックスを選択して、接続検証を有効にします。</b><p>接続検証によって、サーバーは障害発生時に再接続できます。</p></li>
<li><b>「検証方法」ドロップダウンリストから、検証方法を選択します。</b><p>GlassFish Server は、データベース接続を次の方法で検証できます。</p><dl><dt><tt>auto-commit</tt> および <tt>metadata</tt></dt>
<dd><p>GlassFish Server は、<tt>con.getAutoCommit</tt> メソッドと <tt>con.getMetaData</tt> メソッドを呼び出して接続を検証します。 </p>


<hr><p><b>注 - </b>多数の JDBC ドライバが、これらの呼び出しの結果をキャッシュします。その結果、これらの呼び出しを使用すると、信頼できる検証が行われない場合もあります。呼び出しがキャッシュされるかどうかについて、ドライバベンダーに問い合わせる必要があります。</p>


<hr>
</dd>
<dt><tt>custom-validation</tt></dt>
<dd><p>GlassFish Server は、カスタム実装クラスで「検証クラス名」フィールドに指定した、ユーザー定義の検証メカニズムを使用します。</p>

</dd>
<dt><tt>table</tt></dt>
<dd><p>アプリケーションは指定されたデータベース表に問い合わせます。表が存在していてアクセス可能である必要がありますが、行は必要ありません。多くの行を持つ既存の表や、すでに頻繁にアクセスされている表を使用しないでください。</p>

</dd>
</dl>
</li>
<li><b>「検証方法」ドロップダウンリストで「<tt>table</tt>」を選択した場合は、「テーブル名」ドロップダウンリストからデータベース表の名前を選択します。</b></li>
<li><b>「検証方法」ドロップダウンリストで「<tt>custom-validation</tt>」を選択した場合は、カスタム検証の実装クラス名を入力します。</b><p>指定したクラス名は、GlassFish Server からアクセス可能である必要があります。指定したクラスは、 <tt>org.glassfish.api.jdbc.ConnectionValidation</tt>  インタフェースを実装する必要があります。</p></li>
<li><b>単一接続障害が発生したときに、サーバーを閉じ、プールのすべての接続を再度確立するには、「すべての障害で全ての接続を閉じる」チェックボックスを選択します。</b><p>このオプションが無効な場合、個々の接続はそれぞれの使用時のみ再度確立されます。このオプションは、デフォルトでは無効になっています。</p></li>
<li><b>「コンポーネント以外の呼び出し元を許可」の「有効」チェックボックスを選択して、サーブレットフィルタや他社の持続マネージャーなどのコンポーネント以外の呼び出し元がプールを使用できるようにします。</b><p>コンポーネント以外の呼び出し元によって取得された接続は、トランザクションの終わりにコンテナによって自動的に閉じられません。呼び出し元が明示的に閉じる必要があります。このオプションは、デフォルトでは無効になっています。</p></li>
<li>(省略可能) <b>「一般」タブの「フラッシュ」ボタンをクリックして、プールからすべての接続をフラッシュします。</b><p>「フラッシュ」ボタンをクリックすると、既存の接続が破棄されます。プールで確立された接続が再作成され、プールが初期および最小プールサイズに復元されます。</p></li>
<li><b>「保存」をクリックします。</b>
<hr><p><b>ヒント - </b>デフォルト設定に戻すには、「デフォルトを読込み」ボタンをクリックし、「保存」を保存します。</p>


<hr>
</li></ol><p></b>参照</b></p>
<ul><li><p><a href="task-setdbaccess.html">「データベースアクセスを設定する」</a></p>

</li>
<li><p><a href="task-integratejdbcdriver.html">「JDBC ドライバを統合する」</a></p>

</li>
<li><p><a href="task-jdbcresourcenew.html">「JDBC リソースを作成する」</a></p>

</li>
<li><p><a href="task-jdbcresourcesedit.html">「JDBC リソースを編集する」</a></p>

</li>
<li><p><a href="task-jdbcresourcetargets.html">「JDBC リソースのターゲットを編集する」</a></p>

</li>
<li><p><a href="task-jdbcresourcesdelete.html">「JDBC リソースを削除する」</a></p>

</li>
<li><p><a href="task-jdbcconnectionpoolnew.html">「JDBC 接続プールを作成する」</a></p>

</li>
<li><p><a href="task-jdbcconnectionpooledit.html">「JDBC 接続プールの一般設定を編集する」</a></p>

</li>
<li><p><a href="task-verifyconnpoolsettings.html">「接続プール設定を検証する」</a></p>

</li>
<li><p><a href="task-jdbcconnectionpoolproperty.html">「JDBC 接続プールのプロパティーを編集する」</a></p>

</li>
<li><p><a href="task-jdbcconnectionpooldelete.html">「JDBC 接続プールを削除する」</a></p>

</li></ul>


<small>Copyright &#169; 2005, 2011, Oracle and/or its affiliates. All rights reserved. <a href="docinfo.html">著作権について</a></small>
