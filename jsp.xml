<?xml version="1.0" encoding="iso-8859-1"?>

<project name="JSP source integration" default="build" basedir=".">

    <!-- import build.xml for init target and inherited properties -->
    <import file="build.xml"/>

    <target name="build" depends="init">
        <antcall target="jsp.build" />
    </target>

    <!--
        Checkout jsp source and build
    -->
    <target name="jsp.checkout" >
        <echo message="checkout jsp from ${jsp-pom.svn.url}."/>
        <exec executable="svn" dir="${external.dir}" failonerror="true" >
	    <arg line="checkout" />
            <arg line="${jsp-pom.svn.url}" />
            <arg line="jsp/pom" />
	</exec>
        <!-- since the jsp-pom tag contains all the files/directories, -->
        <!-- we want to move those files before checkout out rest of -->
        <!-- api and impl directories. -->
        <delete dir="${external.dir}/jsp/pom/api"/>
        <delete dir="${external.dir}/jsp/pom/impl"/>
        <delete dir="${external.dir}/jsp/pom/repo"/>
        <delete dir="${external.dir}/jsp/pom/www"/>

        <exec executable="svn" dir="${external.dir}" failonerror="true" >
	    <arg line="checkout" />
            <arg line="${jsp-api.svn.url}" />
            <arg line="jsp/api" />
	</exec>
        <exec executable="svn" dir="${external.dir}" failonerror="true" >
	    <arg line="checkout" />
            <arg line="${jsp-impl.svn.url}" />
            <arg line="jsp/impl" />
	</exec>
    </target>

    <target name="jsp.build" depends="jsp.checkout" >
        <!-- build jsp -->
        <exec executable="mvn" dir="${external.dir}/jsp/pom" failonerror="true" >
	    <arg line="-Dmaven.repo.local=${maven.repo.local}" />
            <arg line="install" />
	</exec>
        <exec executable="mvn" dir="${external.dir}/jsp/api" failonerror="true" >
	    <arg line="-Dmaven.repo.local=${maven.repo.local}" />
            <arg line="install" />
	</exec>
        <exec executable="mvn" dir="${external.dir}/jsp/impl" failonerror="true" >
	    <arg line="-Dmaven.repo.local=${maven.repo.local}" />
            <arg line="install" />
	</exec>
    </target>

</project>
