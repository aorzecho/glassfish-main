<?xml version="1.0" encoding="iso-8859-1"?>

<project name="gmbal source integration" default="build" basedir=".">
    <property file="${basedir}/build.properties"/>
    <echo message="gmbal.version=${gmbal.version}"/>
    <import file="build.xml"/>
    <import file="build-taskdefs.xml"/>

    <target name="build" depends="init">
        <property name="local.maven.ant.tasks.jar" value="../../${maven.ant.tasks.jar}"/>
        <hg.clone tag="VERSION-${gmbal.version}" repo="${gmbal.hg.url}" dest="${gmbal.dir}"/>
        <ant antfile="build.xml" dir="${external.dir}/${gmbal.dir}">
            <target name="all"/>
            <target name="release-local"/>
        </ant>
        <antcall target="gmbal.publish.local"/>
    </target>

    <target name="gmbal.publish.local">
        <mvn.publish.local 
            jar="${external.dir}/${gmbal.dir}/dist/bundles/gmbal.jar" 
            mvngroup="${gmbal.groupid}" 
            mvnartid="${gmbal.artifactid}" 
            mvnversion="${gmbal.version}"/>
    </target>

</project>

