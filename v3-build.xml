<?xml version="1.0" encoding="iso-8859-1"?>

<project name="These v3 modules are built before external since external has dependencies on them" default="build" basedir=".">
    <!-- import build.xml for init target and inherited properties -->
    <import file="build.xml"/>

    <target name="build">
        <antcall target="javax.transaction.build" />
        <antcall target="javax.resource.build" />
        <antcall target="javax.security.auth.message" />
    </target>

    <!-- wsit.xml has a dependency on javax.transaction -->
    <target name="javax.transaction.build" >
        <filter token="GROUP_ID" value="org.glassfish"/>
        <filter token="ARTIFACT_ID" value="javax.transaction"/>
        <filter token="VERSION" value="3.0-SNAPSHOT"/>
        <filter token="PACKAGING" value="jar"/>
        <copy file="alternate-pom.xml.template" tofile="/tmp/javax-transaction.xml"
              filtering="true" failonerror="false"/>
        <exec executable="mvn" dir="${v3.dir}/transaction/javax.transaction" failonerror="true" >
	    <arg line="-Dmaven.repo.local=${maven.repo.local}" />
            <arg line="-f /tmp/javax-transaction.xml" />
            <arg line="install" />
	</exec>
        <delete file="/tmp/javax-transaction.xml"/>
    </target>

    <!-- wsit.xml has a dependency on javax.transaction -->
    <target name="javax.resource.build" >
        <filter token="GROUP_ID" value="org.glassfish"/>
        <filter token="ARTIFACT_ID" value="javax.resource"/>
        <filter token="VERSION" value="3.0-SNAPSHOT"/>
        <filter token="PACKAGING" value="jar"/>
        <copy file="alternate-pom.xml.template" tofile="/tmp/javax-resource.xml"
              filtering="true" failonerror="false"/>
        <exec executable="mvn" dir="${v3.dir}/connectors/javax.resource" failonerror="true" >
	    <arg line="-Dmaven.repo.local=${maven.repo.local}" />
            <arg line="-f /tmp/javax-resource.xml" />
            <arg line="install" />
	</exec>
        <delete file="/tmp/javax-resource.xml"/>
    </target>

    <!-- wsit.xml has a dependency on javax.security.auth.message -->
    <target name="javax.security.auth.message" >
        <filter token="GROUP_ID" value="org.glassfish"/>
        <filter token="ARTIFACT_ID" value="javax.security.auth.message"/>
        <filter token="VERSION" value="3.0-SNAPSHOT"/>
        <filter token="PACKAGING" value="jar"/>
        <copy file="alternate-pom.xml.template" tofile="/tmp/javax-security-auth-message.xml"
              filtering="true" failonerror="false"/>
        <exec executable="mvn" dir="${v3.dir}/security/javax.security.auth.message" failonerror="true" >
	    <arg line="-Dmaven.repo.local=${maven.repo.local}" />
            <arg line="-f /tmp/javax-security-auth-message.xml" />
            <arg line="install" />
	</exec>
        <delete file="/tmp/javax-security-auth-message.xml"/>
    </target>
</project>
